<h1 align="center">Утилита для заливки в БД выборки по СНИЛС</h1>
<h3 align="center">(WEB-версия утилиты InsertMeSoft)</h3>

<hr>

## Проект реализован с использованием
Python = Java = CSS = JavaScript = JQuery = HTML = Flask = PostgreSQL = SQLAlchemy = Jinja2 = DB2 for z/OS

![](/design/icons/Python.png)&emsp;
![](/design/icons/Java.png)&emsp;
![](/design/icons/css.png)&emsp;
![](/design/icons/js.png)&emsp;
![](/design/icons/jquery.png)&emsp;
![](/design/icons/html.png)&emsp;
![](/design/icons/flask.png)&emsp;
![](/design/icons/postgresql.png)&emsp;
![](/design/icons/sqlalchemy.png)&emsp;
![ ](/design/icons/jinja.png)&emsp;
![ ](/design/icons/db2.png)

<hr>


## Назначение утилиты: 

1. Создание скрипта для получения выборки по СНИЛС / нескольких СНИЛС.
2. Обработка выборки данных по СНИЛС из одной БД, создание скрипта для заливки (набор Insert'ов) этих данных на другую БД.
3. Заливка выборки на стенд.
4. Копирование (а также множественное клонирование) СНИЛС с одного стенда на другой (или на тот же стенд) с возможностью изменения номера СНИЛС.

Используется для заливки данных со стендов Заказчика на наши тестовые стенды или между нашими стендами.

<hr>

## Вход в программу:

При входе на страницу http://***/ появится окно авторизации:

![ ](/design/images/login.png)

## Внешний вид:

![ ](/design/images/vid1.png)

## Раздел "InsertMeSoft" 

является основным в работе со СНИЛСами.

Для обработки выборки необходимо 

* Выбрать БД тестового стенда. При этом будет автоматически показан JDBC URL для точной идентификации БД пользователем (реализовано по просьбе УСПН).
* Выбрать режим работы с помощью набора чекбоксов:
"Автозаливка в БД" - После формирования инсёртов они будут автоматически выполнены. То есть, заливка в БД произойдёт без участия пользователя. Работает только в случае, когда заливается ровно один СНИЛС.
  * "Не все doc_mass" - не загружать "лишние" записи (для ИП). Некоторые выборки по СНИЛСу ИП или крупного предприятия содержат в таблице SPU_DOC_MASS записи с рег.номером этого ИП, но относящиеся к другим ИП (другим снилсам). \
  Иногда их очень много (сотни и даже тысячи, если предприятие большое), и они фактически не нужны. В этом случае лучше такие записи не загружать.
  * "Случайные ФИО" - Для СНИЛСов ФИО выбираются случайным образом.
  * "Загружать буферные таблицы" - Инсерты по всем схемам, включая буферные таблицы. Если выключен - только по SPUMST и USPN.
* Выбрать файл с выборкой для заливки. Кодировка файла определяется автоматически, но предпочтительна "utf-8 без BOM".
* Нажать на кнопку "Старт !". Кнопка становится неактивной и вместо неё появляется картинка с улиткой. Это значит, нужно подождать. \
После завершения работы утилиты в текстовом окне появятся сообщения (журнал) с информацией о ходе работы утилиты. \
Если счёт уже есть в БД, появляется всплывающий запрос, нужно ли заливать заново.

После формирования инсёртов в поле под чекбоксами пишется ACC_ID из обработанной выборки (если счетов несколько, пишутся все через запятую).

![ ](/design/images/insert.png)

## Раздел "Файл с инсёртами"

Позволяет посмотреть содержимое сформированного скрипта, а также скачать файл на компьютер пользователя.

![ ](/design/images/file.png)


<hr>
